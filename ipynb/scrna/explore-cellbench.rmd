```{r}
library(Seurat)
library(magrittr)
library(ggplot2)
library(cowplot)
theme_set(theme_bw())
```
```{r}
file <- "data/cellbench/cellbench-seurat.rds"
cellbench <- readRDS(file)
```
```{r}
cellbench <- cellbench %>%
  FindVariableFeatures() %>%
  ScaleData(do.scale = FALSE) %>%
  RunPCA()

head(cellbench@meta.data)
```
```{r}
# TODO: Are the HVGs mainly consisting of features that are not present in all batches
ax1 <- DimPlot(
  cellbench, reduction = "pca",
  group.by = "orig.ident", shuffle = TRUE
)
ax2 <- DimPlot(
  cellbench, reduction = "pca",
  group.by = "cell_line", shuffle = TRUE
)
ax <- plot_grid(ax1, ax2, rel_widths = c(0.9, 1))
file <- "tmp/pca-cellbench.png"
ggsave(file, ax, width = 10, height = 5)
```